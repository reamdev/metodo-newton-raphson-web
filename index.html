<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Método de Newton con Derivadas Exactas</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/mathquill/build/mathquill.css"
    />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="shortcut icon" href="./resources/favicon.ico" type="image/x-icon" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.6.0/math.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/nerdamer.core.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Calculus.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Algebra.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.12/Extra.js"></script>
    <!-- CSS de KaTeX -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    />

    <!-- JS de KaTeX -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  </head>
  <body class="bg-white text-black dark:bg-gray-800 dark:text-white h-screen overflow-hidden">
    <header class="flex items-center justify-between px-6 py-2 bg-gray-100 dark:bg-gray-800 shadow-md">
      <div class="w-12 h-12 flex-shrink-0">
        <img src="resources/EscudoEscuela.png" alt="Escudo escuela" class="w-full h-full object-contain"/>
      </div>
      <h1 class="text-center text-xl md:text-2xl font-bold text-gray-800 dark:text-white flex-1">Método de Newton con Cálculo Exacto de Derivadas</h1>
      <div class="flex items-center justify-end">
        <label class="flex items-center cursor-pointer">
          <!-- Sol y Luna -->
          <span class="text-lg text-yellow-500 dark:text-gray-200">
            <span class="block dark:hidden">☀️</span>
            <span class="hidden dark:block">🌙</span>
          </span>

          <!-- Input invisible y peer -->
          <input id="theme-toggle" type="checkbox" class="sr-only peer">

          <!-- Switch container -->
          <div class="ml-2 w-10 h-5 bg-gray-300 dark:bg-gray-600 rounded-full relative transition">
            <!-- La bolita -->
            <div id="theme-white-ball" class="absolute top-0.5 left-0.5 w-4 h-4 bg-white rounded-full transition-all duration-300 peer-checked:translate-x-5"></div>
          </div>
        </label>
      </div>
    </header>

    <main class="bg-white dark:bg-gray-900 text-black dark:text-white min-h-screen px-4 py-6">
      <div class="mb-4 text-right">
        <button id="toggle-iteracciones" class="text-sm bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded transition">
          Ocultar Iteraciones
        </button>
      </div>

      <!-- Columnas -->
      <div id="main-layout" class="flex gap-4">
        <!-- Columna 1: Funcion -->
        <div class="basis-[20%] shrink-0 flex flex-col h-full space-y-4 relative">
          <div class="flex items-center space-x-2">
            <p class="font-semibold mb-1">Función</p>
          </div>
          <div class="flex items-stretch space-x-2 relative">
            <div id="function-field" class="mq-editable-field border border-gray-300 dark:border-gray-600 p-2 rounded w-full caret-black dark:caret-white">
              x^3 + 3*x^2 - 6
            </div>
            <button id="btn-teclado" class="rounded bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 shadow transition px-3" title="Mostrar teclado">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-gray-800 dark:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 6.75h15a1.5 1.5 0 0 1 1.5 1.5v7.5a1.5 1.5 0 0 1-1.5 1.5h-15a1.5 1.5 0 0 1-1.5-1.5v-7.5a1.5 1.5 0 0 1 1.5-1.5zM6 10.5h.008M9 10.5h.008M12 10.5h.008M15 10.5h.008M18 10.5h.008M6 13.5h12" />
              </svg>
            </button>

            <!-- Este es el teclado flotante que se mostrará a la derecha -->
            <div id="teclado-flotante"
                class="hidden absolute left-full ml-2 top-0 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 p-2 rounded shadow flex flex-row gap-2 z-50 h-full items-center">
              <button onclick="insertar('sqrt')" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-black dark:text-white rounded hover:bg-gray-200 dark:hover:bg-gray-600">√</button>
              <button onclick="insertar('^')" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-black dark:text-white rounded hover:bg-gray-200 dark:hover:bg-gray-600">xⁿ</button>
              <button onclick="insertar('sin')" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-black dark:text-white rounded hover:bg-gray-200 dark:hover:bg-gray-600">sin</button>
              <button onclick="insertar('cos')" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-black dark:text-white rounded hover:bg-gray-200 dark:hover:bg-gray-600">cos</button>
              <button onclick="insertar('tan')" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-black dark:text-white rounded hover:bg-gray-200 dark:hover:bg-gray-600">tan</button>
            </div>
          </div>

          <p class="font-semibold">Derivada:</p>
          <div id="derivative-display" class="text-center p-2 border border-gray-300 dark:border-gray-600 rounded">
            <p id="derivative-text"></p>
          </div>

          <div class="space-y-2">
            <label for="x0" class="block font-medium">Punto inicial (x₀):</label>
            <input class="border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded px-2 py-1 w-full" type="number" id="x0" value="1" step="0.1" />
          </div>

          <div class="space-y-2">
            <label for="tolerancia" class="block font-medium">Tolerancia:</label>
            <input class="border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded px-2 py-1 w-full" type="number" id="tolerancia" value="0.000001" step="0.000001" />
          </div>

          <div id="space-x-4">
            <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded" onclick="runNewton()">Calcular</button>
            <button class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded" onclick="reset()">Reiniciar</button>
          </div>
        </div>

        <!-- Columna 2: Grafico -->
        <div id="col-grafico" class="grow relative h-[500px] bg-white dark:bg-gray-800 rounded shadow p-4 transition-all duration-300">
          <canvas id="newton-chart" class="absolute top-0 left-0 w-full h-full"></canvas>
        </div>

        <!-- Columna 3: Funcion -->
        <div id="col-iteracciones" class="basis-[24%] shrink-0 bg-white dark:bg-gray-800 rounded shadow p-4 overflow-auto transition-all duration-300 flex flex-col h-[500px]">
          <!-- Mitad superior: Interacciones -->
          <div class="flex-1 overflow-auto">
            <h3 class="text-lg font-bold mb-2">Interacciones</h3>
            <table id="iteracciones-table" class="w-full text-sm border border-collapse border-gray-300 dark:border-gray-700">
              <thead class="bg-gray-100 dark:bg-gray-800">
                <tr>
                  <th class="border px-2 py-1">N°</th>
                  <th class="border px-2 py-1">x₁</th>
                  <th class="border px-2 py-1">f(x)</th>
                  <th class="border px-2 py-1">f'(x)</th>
                  <th class="border px-2 py-1">Error</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5" class="text-center border py-2">Sin datos</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Mitad inferior: Desarrolladores -->
          <div class="mt-4 p-2 border-t border-gray-300 dark:border-gray-600">
            <h3 class="text-md font-semibold mb-2">Desarrolladores</h3>
            <div class="flex justify-between text-sm">
              <!-- Primera columna (3 desarrolladores) -->
              <ul class="space-y-1">
                <li>👨‍💻 Rafael Arriaga</li>
                <li>👩‍💻 Valeria Cardenas</li>
                <li>👨‍💻 Renzo Lopez</li>
              </ul>

              <!-- Segunda columna (2 desarrolladores) -->
              <ul class="space-y-1">
                <li>👨‍💻 Angel Marco</li>
                <li>👨‍💻 Cristian Asensios</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathquill/build/mathquill.min.js"></script>
    <script src="./js/main.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
      };
    </script>
    <!-- Tailwind -->
  </body>
</html>
